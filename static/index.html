<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>PhenBOT - Advanced Study Companion</title>

    <!-- icons + fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>

    <style>
    /* --- keep most of your styling but enlarged chat --- */
    :root {
        --primary-bg: #0f0f23;
        --secondary-bg: #1a1a2e;
        --tertiary-bg: #16213e;
        --card-bg: rgba(30, 41, 59, 0.85);
        --card-border: rgba(71, 85, 105, 0.28);
        --primary-blue: #4f46e5;
        --primary-purple: #7c3aed;
        --primary-green: #10b981;
        --primary-cyan: #06b6d4;
        --text-primary: #f8fafc;
        --text-secondary: #e2e8f0;
        --text-muted: #94a3b8;
    }

    * { box-sizing: border-box; margin:0; padding:0; }
    body {
        font-family: 'Inter', sans-serif;
        background: linear-gradient(135deg, var(--primary-bg), var(--secondary-bg) 50%, var(--tertiary-bg));
        color: var(--text-secondary);
        min-height:100vh;
    }

    .app-container { display:flex; min-height:100vh; }

    /* sidebar */
    .sidebar {
        width:280px; background:var(--card-bg); border-right:1px solid var(--card-border); backdrop-filter: blur(10px);
        display:flex; flex-direction:column;
    }
    .sidebar-header { padding:20px; background: linear-gradient(135deg,var(--primary-blue),var(--primary-purple)); color:white;}
    .logo { font-weight:700; font-size:1.4rem; display:flex; align-items:center; gap:10px;}
    .sidebar-nav { padding:10px 0; flex:1; overflow:auto;}
    .nav-item { padding:12px 18px; display:flex; gap:12px; align-items:center; color:var(--text-muted); cursor:pointer; border-left:3px solid transparent; }
    .nav-item.active, .nav-item:hover { background: rgba(79,70,229,0.08); color:var(--primary-blue); border-left-color:var(--primary-blue); }

    .user-info { padding:12px 18px; border-top:1px solid var(--card-border); display:flex; gap:12px; align-items:center; }
    .user-avatar { width:44px; height:44px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,var(--primary-green),var(--primary-cyan)); color:white; font-weight:700; }

    /* main */
    .main-content { flex:1; display:flex; flex-direction:column; }
    .top-bar { padding:14px 20px; display:flex; justify-content:space-between; align-items:center; background:var(--card-bg); border-bottom:1px solid var(--card-border); backdrop-filter: blur(8px); }
    .page-title { font-weight:600; font-size:1.4rem; color:var(--text-primary); display:flex; gap:12px; align-items:center; }
    .status-badge { display:flex; gap:8px; align-items:center; background:rgba(16,185,129,0.12); padding:6px 12px; border-radius:999px; color:var(--primary-green); font-weight:600; }

    .content-area { padding:20px; overflow:auto; display:grid; grid-template-columns: 1fr 380px; gap:20px; align-items:start; }

    /* enlarged chat column */
    .ai-chat-container {
        background:var(--card-bg); border-radius:16px; border:1px solid var(--card-border); display:flex; flex-direction:column; height: calc(100vh - 160px);
    }

    .chat-header { padding:16px 20px; display:flex; justify-content:space-between; align-items:center; background: linear-gradient(135deg,var(--primary-green),var(--primary-cyan)); color:white; border-top-left-radius:16px; border-top-right-radius:16px; }
    .chat-messages { padding:20px; overflow:auto; flex:1; display:flex; flex-direction:column; gap:14px; }

    /* Make messages bigger (user asked for bigger) */
    .message { display:flex; gap:12px; align-items:flex-start; max-width:100%; }
    .message.user { flex-direction:row-reverse; }
    .message-avatar { width:46px; height:46px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; color:white; }
    .message-content { padding:14px 18px; border-radius:16px; line-height:1.5; font-size:1.05rem; max-width:90%; box-shadow: 0 4px 18px rgba(2,6,23,0.6); }
    .message.user .message-content { background: linear-gradient(135deg,var(--primary-blue),var(--primary-purple)); color:white; border-bottom-right-radius:8px; }
    .message.bot .message-content { background: rgba(15,23,42,0.85); color:var(--text-secondary); border-left:4px solid var(--primary-green); }

    .chat-input-area { padding:14px 18px; border-top:1px solid var(--card-border); background: rgba(15,23,42,0.45); border-bottom-left-radius:16px; border-bottom-right-radius:16px; }
    .input-container { display:flex; gap:12px; align-items:flex-end; }
    .chat-input { flex:1; min-height:56px; max-height:160px; padding:14px; border-radius:28px; resize:none; border:1px solid var(--card-border); background:rgba(15,23,42,0.8); color:var(--text-secondary); font-size:1rem; }
    .send-btn { width:56px; height:56px; border-radius:50%; border:none; background:linear-gradient(135deg,var(--primary-green),var(--primary-cyan)); color:white; cursor:pointer; font-size:18px; display:flex; align-items:center; justify-content:center; }

    /* right column (tools) */
    .right-column { display:flex; flex-direction:column; gap:20px; }
    .upload-container, .flashcards-container, .pomodoro-container { background:var(--card-bg); padding:16px; border-radius:12px; border:1px solid var(--card-border); }

    .upload-area { border:2px dashed var(--card-border); padding:18px; border-radius:12px; text-align:center; cursor:pointer; margin-bottom:12px; }
    .pdf-actions { display:flex; gap:8px; justify-content:center; margin-top:8px; }
    .action-btn { padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:600; }

    .flashcards-list { max-height:280px; overflow:auto; display:flex; flex-direction:column; gap:10px; margin-top:12px; }
    .flashcard { background:linear-gradient(135deg, rgba(79,70,229,0.06), rgba(124,58,237,0.04)); border-radius:12px; padding:12px; cursor:pointer; perspective:800px; }

    /* small responsive */
    @media (max-width: 980px) {
        .content-area { grid-template-columns: 1fr; }
        .sidebar { display:none; }
    }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo"><i class="fas fa-brain"></i> PhenBOT</div>
                <div style="font-size:0.9rem; opacity:0.95;">Advanced Study Companion</div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-item active" data-tab="ai-chat"><i class="fas fa-comments"></i> AI Chat Assistant</div>
                <div class="nav-item" data-tab="pdf-tools"><i class="fas fa-file-pdf"></i> PDF Tools</div>
                <div class="nav-item" data-tab="flashcards"><i class="fas fa-layer-group"></i> Flashcards</div>
                <div class="nav-item" data-tab="pomodoro"><i class="fas fa-clock"></i> Pomodoro Timer</div>
                <div class="nav-item" data-tab="analytics"><i class="fas fa-chart-line"></i> Analytics</div>
                <div class="nav-item" data-tab="settings"><i class="fas fa-cog"></i> Settings</div>
            </nav>

            <div class="user-info">
                <div class="user-avatar">{{ username[0].upper() if username else 'A' }}</div>
                <div>
                    <div style="font-weight:700; color:var(--text-primary);">{{ username or 'ashrith07' }}</div>
                    <div style="font-size:0.8rem; color:var(--text-muted);">Premium User</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="top-bar">
                <div style="display:flex;gap:12px;align-items:center;">
                    <div class="page-title"><i class="fas fa-robot"></i> <span id="pageTitle">AI Chat Assistant</span></div>
                    <div class="status-badge"><i class="fas fa-circle"></i> <span id="aiStatus">AI Online</span></div>
                </div>
                <div style="display:flex;gap:12px;align-items:center;">
                    <div class="pomodoro-mini" id="pomodoroMini" style="display:flex;gap:8px;padding:8px 12px;border-radius:999px;background:rgba(245,158,11,0.12);color:var(--primary-blue);font-weight:700;">
                        <i class="fas fa-clock"></i>
                        <span id="miniTimer">25:00</span>
                    </div>
                    <button class="logout-btn" onclick="logout()" style="background:rgba(239,68,68,0.12);color:var(--primary-red);border:none;padding:8px 12px;border-radius:8px;cursor:pointer;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>

            <div class="content-area">
                <!-- Left: Chat -->
                <div>
                    <div class="ai-chat-container" id="aiChat">
                        <div class="chat-header">
                            <div style="display:flex;gap:12px;align-items:center;">
                                <div style="font-weight:700;font-size:1.1rem;">AI Study Assistant</div>
                                <select id="chatMode" style="padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.08);color:white;">
                                    <option value="normal">Normal</option>
                                    <option value="analogy">Analogy</option>
                                    <option value="quiz">Quiz</option>
                                    <option value="teach">Teaching</option>
                                    <option value="socratic">Socratic</option>
                                    <option value="explain">ELI5</option>
                                </select>

                                <select id="responseLength" style="padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.08);color:white;">
                                    <option value="short">Short</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="detailed">Detailed</option>
                                </select>
                            </div>

                            <div style="display:flex;align-items:center;gap:10px;">
                                <button class="voice-btn" id="voiceBtn" title="Voice Chat" style="background:rgba(255,255,255,0.08);border-radius:50%;width:44px;height:44px;border:none;color:white;cursor:pointer;">
                                    <i class="fas fa-microphone"></i>
                                </button>
                            </div>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <div class="message bot">
                                <div class="message-avatar" style="background:linear-gradient(135deg,var(--primary-green),var(--primary-cyan));"><i class="fas fa-robot"></i></div>
                                <div class="message-content">
                                    Hello! I'm PhenBOT — your study companion. Choose a mode and ask me anything. Try: "Explain Kruskal's algorithm in an analogy" or upload a PDF to summarize.
                                </div>
                            </div>
                        </div>

                        <div class="chat-input-area">
                            <div class="input-container">
                                <textarea id="chatInput" class="chat-input" placeholder="Ask me anything... (Shift+Enter for newline, Enter to send)"></textarea>
                                <button id="sendBtn" class="send-btn" title="Send"><i class="fas fa-paper-plane"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Tools -->
                <div class="right-column">
                    <!-- PDF Upload -->
                    <div class="upload-container" id="pdfTab">
                        <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
                            <div style="font-weight:700;font-size:1.05rem;">PDF Tools</div>
                            <div style="color:var(--text-muted);font-size:0.9rem;">Summarize or create flashcards</div>
                        </div>

                        <div class="upload-area" id="uploadArea">
                            <div style="font-size:1.2rem;color:var(--text-primary)"><i class="fas fa-file-pdf"></i></div>
                            <div style="margin-top:8px;color:var(--text-muted)">Click to upload PDF (or drag & drop)</div>
                            <input type="file" id="pdfInput" accept="application/pdf" style="display:none;"/>
                        </div>

                        <div style="display:flex;gap:8px;align-items:center;justify-content:center;margin-top:6px;">
                            <button class="action-btn" id="summarizeBtn" style="background:linear-gradient(135deg,var(--primary-blue),var(--primary-purple));color:white;">Summarize PDF</button>
                            <button class="action-btn" id="flashcardBtn" style="background:linear-gradient(135deg,var(--primary-green),var(--primary-cyan));color:white;">Generate Flashcards</button>
                        </div>

                        <div style="display:flex;gap:8px;align-items:center;justify-content:center;margin-top:10px;">
                            <input id="numCards" type="number" value="8" min="1" max="40" style="width:80px;padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)"/>
                            <select id="cardDifficulty" style="padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)">
                                <option value="easy">Easy</option>
                                <option value="medium" selected>Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                        </div>

                        <div id="pdfResult" style="margin-top:12px;color:var(--text-secondary);font-size:0.95rem;white-space:pre-wrap;"></div>
                    </div>

                    <!-- Flashcards -->
                    <div class="flashcards-container" id="flashcardsTab">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div style="font-weight:700;">Flashcards</div>
                            <div style="font-size:0.85rem;color:var(--text-muted)">Click to flip</div>
                        </div>

                        <div style="margin-top:10px;display:flex;gap:8px;">
                            <input id="newQuestion" placeholder="Question" style="flex:1;padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)"/>
                            <input id="newAnswer" placeholder="Answer" style="flex:1;padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)"/>
                            <button id="addFlashcardBtn" class="action-btn" style="background:rgba(79,70,229,0.12);">Add</button>
                        </div>

                        <div class="flashcards-list" id="flashcardsList">
                            <!-- generated or manual flashcards appear here -->
                        </div>
                    </div>

                    <!-- Pomodoro -->
                    <div class="pomodoro-container" id="pomodoroTab">
                        <div style="font-weight:700;">Pomodoro Timer</div>
                        <div style="margin-top:8px;font-size:2.2rem;font-weight:800;color:var(--primary-orange)" id="timerDisplay">25:00</div>
                        <div style="display:flex;gap:8px;justify-content:center;margin-top:12px;">
                            <button id="startTimerBtn" class="action-btn" style="background:linear-gradient(135deg,var(--primary-green),var(--primary-cyan));color:white;">Start</button>
                            <button id="pauseTimerBtn" class="action-btn" style="background:rgba(71,85,105,0.12);">Pause</button>
                            <button id="resetTimerBtn" class="action-btn" style="background:rgba(239,68,68,0.12);">Reset</button>
                        </div>

                        <div style="margin-top:12px;display:flex;gap:8px;justify-content:center;">
                            <input id="focusMinutes" type="number" min="1" value="25" style="width:80px;padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)"/>
                            <input id="breakMinutes" type="number" min="1" value="5" style="width:80px;padding:8px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:var(--text-secondary)"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- App JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
